{% extends "base.html" %}

{% block title %}Carrello{% endblock %}

{% block main %}
    <h1>Carrello</h1>

    {% if current_user.profiles %}
        {% for profile in current_user.profiles %}
            {% if profile.id == session['current_profile_id'] %}
                {% if profile.cart_items %}
                    {%for item in profile.cart_items %}
                        <p>
                            <a href="{{url_for('product.access_product', product_id = item.product_id)}}">{{ item.product.name }}</a> -- ${{item.product.price}}
                            <form action="{{url_for('cart.change_quantity_cart_item',item_id=item.id)}}" method="POST">
                                <input type="number" name="quantity" value="{{item.quantity}}" required min="1" max="{{item.product.availability}}">
                                <button type="submit">Applica</button>
                            </form>
                            <a href="{{url_for('cart.delete_item_from_cart', item_id = item.id)}}">Elimina</a>
                        </p>
                    {% endfor %}
                    <a href="{{url_for('cart.order_cart_items')}}">Continua con l'ordine</a>
                {% else %}
                    <p>Carrello vuoto</p>
                {% endif %}
            {% endif %}
        {% endfor %}
    {% endif %}
{% endblock %}